#include <stdio.h>
#include <stdlib.h>
#include <conio.h>

// Funções para as operações de frações
void obter_fracoes();
void somar_fracoes(int x, int y, int u, int v);
void subtrair_fracoes(int x, int y, int u, int v);
void multiplicar_fracoes(int x, int y, int u, int v);
void dividir_fracoes(int x, int y, int u, int v);
void simplificar_fracoes(int *x, int *y);

// Variáveis globais para armazenar as frações
int a, b, c, d;

int main(int args, char * arg[])
{
    char r;

    while (1)
    {
        system("CLS");
        printf("Calculadora de Frações\n");
        printf("1. Somar\n");
        printf("2. Subtrair\n");
        printf("3. Multiplicar\n");
        printf("4. Dividir\n");
        printf("5. Fim\n");
        printf("Escolha uma opção: ");
        r = getche(); // Lê uma tecla pressionada

        switch (r)
        {
            case '1':
                obter_fracoes();
                somar_fracoes(a, b, c, d);
                break;
            case '2':
                obter_fracoes();
                subtrair_fracoes(a, b, c, d);
                break;
            case '3':
                obter_fracoes();
                multiplicar_fracoes(a, b, c, d);
                break;
            case '4':
                obter_fracoes();
                dividir_fracoes(a, b, c, d);
                break;
            case '5':
                printf("\nPrograma encerrado.\n");
                exit(0);
            default:
                printf("\nOpção inválida! Tente novamente.\n");
                break;
        }

        printf("\nPressione qualquer tecla para continuar...");
        getche(); // Espera o usuário pressionar uma tecla para continuar
    }
}

// Função para obter as frações do usuário
void obter_fracoes()
{
    printf("\nDigite a primeira fração (numerador/denominador): ");
    scanf("%d/%d", &a, &b);

    printf("Digite a segunda fração (numerador/denominador): ");
    scanf("%d/%d", &c, &d);
}

// Função para somar frações
void somar_fracoes(int x, int y, int u, int v)
{
    int numerador = (x * v) + (y * u);
    int denominador = y * v;
    
    simplificar_fracoes(&numerador, &denominador);
    
    printf("\nResultado da soma: %d/%d\n", numerador, denominador);
}

// Função para subtrair frações
void subtrair_fracoes(int x, int y, int u, int v)
{
    int numerador = (x * v) - (y * u);
    int denominador = y * v;
    
    simplificar_fracoes(&numerador, &denominador);
    
    printf("\nResultado da subtração: %d/%d\n", numerador, denominador);
}

// Função para multiplicar frações
void multiplicar_fracoes(int x, int y, int u, int v)
{
    int numerador = x * u;
    int denominador = y * v;
    
    simplificar_fracoes(&numerador, &denominador);
    
    printf("\nResultado da multiplicação: %d/%d\n", numerador, denominador);
}

// Função para dividir frações
void dividir_fracoes(int x, int y, int u, int v)
{
    if (u == 0)
    {
        printf("\nErro: Não é possível dividir por zero.\n");
        return;
    }

    int numerador = x * v;
    int denominador = y * u;

    simplificar_fracoes(&numerador, &denominador);

    printf("\nResultado da divisão: %d/%d\n", numerador, denominador);
}

// Função para simplificar frações
void simplificar_fracoes(int *x, int *y)
{
    int i, menor = (*x < *y) ? *x : *y;

    for (i = menor; i > 1; i--)
    {
        if (*x % i == 0 && *y % i == 0)
        {
            *x /= i;
            *y /= i;
            break;
        }
    }
}
